class PopselTexture{constructor(e){let s;var t;this.pupselNumber=RESOLUTION,this.brushNumber=15,this.brushSize=DOMINANTSIDE*BRUSHSIZE,this.brushStrokeWeight=1,this.lowDist=3,this.medDist=6,this.highDist=12,this.spriteCount=10,this.shape=e,this.pupselSize=DOMINANTSIDE/this.pupselNumber,this.pupselColors=PALETTE.pixelColors,this.pattern=getRandomFromList([0,0,0,3,4,5]),this.pupsels=[],this.sprites={},this.buffer=createGraphics(.3*DOMINANTSIDE,.3*DOMINANTSIDE),this.drawShape();for(var h=0,i=0;i<=this.buffer.height;i+=this.pupselSize)for(var r=0;r<=this.buffer.width;r+=this.pupselSize)h+=1,insidePolygon([r,i],this.shape.coords)&&(t=this.shape.color,this.pattern>0&&h%this.pattern==0&&(s=brightness(t)>50?-80:80,t=color(red(t)+s,green(t)+s,blue(t)+s)),t=brightenSuperNew(t,map(i,0,this.buffer.height,-10,10)),this.createBrushTiles(r,i,t))}drawShape(){this.bufferShape=createGraphics(this.buffer.width,this.buffer.height),this.bufferShape.push(),this.bufferShape.drawingContext.filter="blur(10px)",this.bufferShape.stroke("#323232"),this.bufferShape.strokeWeight(8),this.bufferShape.noFill(),this.bufferShape.beginShape(),this.bufferShape.vertex(this.shape.A.x,this.shape.A.y),this.bufferShape.vertex(this.shape.B.x,this.shape.B.y),this.bufferShape.vertex(this.shape.C.x,this.shape.C.y),this.bufferShape.endShape(CLOSE),this.bufferShape.pop(),this.buffer.image(this.bufferShape,0,0)}createBrushTiles(e,s,t){var h,i;if(h=t.toString("#rrggbb"),void 0===this.sprites[h]){for(var r=[],p=0;p<this.spriteCount;p++)r.push(this.createPupselSprite(h));this.sprites[h]=r}push(),i=getRandomFromList(this.sprites[h]),this.buffer.imageMode(CENTER),this.buffer.image(i,e,s),pop()}createPupselSprite(e){let s=createGraphics(2*this.brushSize,2*this.brushSize);for(var t=0;t<this.brushNumber;t++)s.push(),s.stroke(distortColorSuperNew(e,30)),s.strokeWeight(this.brushStrokeWeight),s.line(s.width/2,s.height/2,s.width/2+getRandomFromInterval(-this.brushSize,this.brushSize),s.height/2+getRandomFromInterval(-this.brushSize,this.brushSize)),s.pop();return s}}