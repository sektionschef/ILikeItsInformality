class PopselTexture{constructor(e){let s;var h;this.pupselNumber=getRandomFromList([400,300,200]),this.brushNumber=15,this.brushSize=e.brushSize,this.brushStrokeWeight=1,this.lowDist=10,this.medDist=20,this.highDist=30,this.spriteCount=10,this.shape=e,this.pupselSize=DOMINANTSIDE/this.pupselNumber,this.pupselColors=PALETTE.pixelColors,this.pattern=getRandomFromList([0,0,0,3,4,5]),this.pupsels=[],this.sprites={},this.buffer=createGraphics(.3*DOMINANTSIDE,.3*DOMINANTSIDE),this.shape.points||this.drawShape();for(var t=0,i=0;i<=this.buffer.height;i+=this.pupselSize)for(var r=0;r<=this.buffer.width;r+=this.pupselSize)t+=1,insidePolygon([r,i],this.shape.coords)&&(h=this.shape.color,this.pattern>0&&t%this.pattern==0&&(s=brightness(h)>50?-50:50,h=color(red(h)+s,green(h)+s,blue(h)+s)),h=brightenSuperNew(h,map(r,this.shape.B.x,this.shape.C.x,-25,25)),this.shape.points?this.showPoints(r,i,h):this.createBrushTiles(r,i,h))}drawShape(){this.strokeWeight=1,this.blurSize=2,this.bufferShape=createGraphics(this.buffer.width,this.buffer.height),this.bufferShape.push(),this.bufferShape.drawingContext.filter=`blur(${this.blurSize}px)`,brightness(this.shape.color)>50?this.strokeColor=color(red(this.shape.color)-100,green(this.shape.color)-100,blue(this.shape.color)-100):this.strokeColor=color(red(this.shape.color)+100,green(this.shape.color)+100,blue(this.shape.color)+100),this.bufferShape.stroke(this.strokeColor),this.bufferShape.strokeWeight(this.strokeWeight),this.bufferShape.noFill(),this.bufferShape.fill(color(red(this.shape.color),green(this.shape.color),blue(this.shape.color),150)),this.bufferShape.beginShape(),this.bufferShape.vertex(this.shape.A.x,this.shape.A.y),this.bufferShape.vertex(this.shape.B.x,this.shape.B.y),this.bufferShape.vertex(this.shape.C.x,this.shape.C.y),this.bufferShape.endShape(CLOSE),this.bufferShape.pop(),this.buffer.image(this.bufferShape,0,0)}showPoints(e,s,h){this.buffer.push(),this.buffer.stroke(h),this.buffer.strokeWeight(5),this.buffer.point(e,s),this.buffer.pop()}createBrushTiles(e,s,h){var t,i;if(t=h.toString("#rrggbb"),void 0===this.sprites[t]){for(var r=[],o=0;o<this.spriteCount;o++)r.push(this.createPupselSprite(t));this.sprites[t]=r}push(),i=getRandomFromList(this.sprites[t]),this.buffer.imageMode(CENTER),this.buffer.image(i,e,s),pop()}createPupselSprite(e){let s=createGraphics(2*this.brushSize,2*this.brushSize);for(var h=0;h<this.brushNumber;h++)s.push(),s.stroke(distortColorSuperNew(e,30)),s.strokeWeight(this.brushStrokeWeight),s.line(s.width/2,s.height/2,s.width/2+getRandomFromInterval(-this.brushSize,this.brushSize),s.height/2+getRandomFromInterval(-this.brushSize,this.brushSize)),s.pop();return s}}